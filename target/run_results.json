{"logs": [], "results": [{"node": {"raw_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from {{ source('datamart', 'dim_opportunity') }}\n\n),\n\nremaned_src as (\n\n    select\n        id,\n        partner_id,\n        country_code_iso3,\n        finished_date,\n        first_appointment_date,\n        partner_service_premium,\n        days_to_first_appointment,\n        stage_name,\n        created_date\n\n    from src\n\n)\n\nselect * from remaned_src", "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "staging", "datamart", "stg_dim_opportunity"], "unique_id": "model.partner_portal.stg_dim_opportunity", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "staging/datamart/stg_dim_opportunity.sql", "original_file_path": "models/staging/datamart/stg_dim_opportunity.sql", "name": "stg_dim_opportunity", "resource_type": "model", "alias": "stg_dim_opportunity", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "transient": true}, "tags": [], "refs": [], "sources": [["datamart", "dim_opportunity"]], "depends_on": {"macros": [], "nodes": ["source.partner_portal.datamart.dim_opportunity"]}, "description": "", "columns": {"id": {"name": "id", "description": "", "meta": {}, "data_type": null, "tags": []}, "partner_id": {"name": "partner_id", "description": "", "meta": {}, "data_type": null, "tags": []}, "country_code_iso3": {"name": "country_code_iso3", "description": "", "meta": {}, "data_type": null, "tags": []}, "finished_date": {"name": "finished_date", "description": "", "meta": {}, "data_type": null, "tags": []}, "first_appointment_date": {"name": "first_appointment_date", "description": "", "meta": {}, "data_type": null, "tags": []}, "partner_service_premium": {"name": "partner_service_premium", "description": "", "meta": {}, "data_type": null, "tags": []}, "days_to_first_appointment": {"name": "days_to_first_appointment", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/staging/datamart/stg_datamart.yml", "build_path": "target/compiled/partner_portal/models/staging/datamart/stg_dim_opportunity.sql", "compiled": true, "compiled_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.datamart.dim_opportunity\n\n),\n\nremaned_src as (\n\n    select\n        id,\n        partner_id,\n        country_code_iso3,\n        finished_date,\n        first_appointment_date,\n        partner_service_premium,\n        days_to_first_appointment,\n        stage_name,\n        created_date\n\n    from src\n\n)\n\nselect * from remaned_src", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.datamart.dim_opportunity\n\n),\n\nremaned_src as (\n\n    select\n        id,\n        partner_id,\n        country_code_iso3,\n        finished_date,\n        first_appointment_date,\n        partner_service_premium,\n        days_to_first_appointment,\n        stage_name,\n        created_date\n\n    from src\n\n)\n\nselect * from remaned_src"}, "error": null, "status": null, "execution_time": 0.04919576644897461, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:37.943122Z", "completed_at": "2020-10-11T08:32:37.991457Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:37.991846Z", "completed_at": "2020-10-11T08:32:37.991860Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from {{ source('datamart', 'dim_partner_subsidiary') }}\n\n),\n\nremaned_src as (\n\n    select\n        id as id,\n        parent_id\n\n    from src\n\n)\n\nselect * from remaned_src", "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "staging", "datamart", "stg_dim_partner_subsidiary"], "unique_id": "model.partner_portal.stg_dim_partner_subsidiary", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "staging/datamart/stg_dim_partner_subsidiary.sql", "original_file_path": "models/staging/datamart/stg_dim_partner_subsidiary.sql", "name": "stg_dim_partner_subsidiary", "resource_type": "model", "alias": "stg_dim_partner_subsidiary", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "transient": true}, "tags": [], "refs": [], "sources": [["datamart", "dim_partner_subsidiary"]], "depends_on": {"macros": [], "nodes": ["source.partner_portal.datamart.dim_partner_subsidiary"]}, "description": "", "columns": {"id": {"name": "id", "description": "", "meta": {}, "data_type": null, "tags": []}, "parent_id": {"name": "parent_id", "description": "", "meta": {}, "data_type": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "models/staging/datamart/stg_datamart.yml", "build_path": "target/compiled/partner_portal/models/staging/datamart/stg_dim_partner_subsidiary.sql", "compiled": true, "compiled_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.datamart.dim_partner_subsidiary\n\n),\n\nremaned_src as (\n\n    select\n        id as id,\n        parent_id\n\n    from src\n\n)\n\nselect * from remaned_src", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.datamart.dim_partner_subsidiary\n\n),\n\nremaned_src as (\n\n    select\n        id as id,\n        parent_id\n\n    from src\n\n)\n\nselect * from remaned_src"}, "error": null, "status": null, "execution_time": 0.03009963035583496, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:37.992491Z", "completed_at": "2020-10-11T08:32:38.021867Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.022190Z", "completed_at": "2020-10-11T08:32:38.022199Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from {{ source('stg_finance', 'navision_item') }}\n\n),\n\nremaned_src as (\n\n    select\n        no_\n        ,country_code_iso3\n        ,item_category_code\n        ,manufacturer_code\n\n    from src\n\n)\n\nselect * from remaned_src", "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "staging", "stg_finance", "stg_navision_item"], "unique_id": "model.partner_portal.stg_navision_item", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "staging/stg_finance/stg_navision_item.sql", "original_file_path": "models/staging/stg_finance/stg_navision_item.sql", "name": "stg_navision_item", "resource_type": "model", "alias": "stg_navision_item", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "transient": true}, "tags": [], "refs": [], "sources": [["stg_finance", "navision_item"]], "depends_on": {"macros": [], "nodes": ["source.partner_portal.stg_finance.navision_item"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/stg_finance/stg_navision_item.sql", "compiled": true, "compiled_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.stg_finance.navision_item\n\n),\n\nremaned_src as (\n\n    select\n        no_\n        ,country_code_iso3\n        ,item_category_code\n        ,manufacturer_code\n\n    from src\n\n)\n\nselect * from remaned_src", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.stg_finance.navision_item\n\n),\n\nremaned_src as (\n\n    select\n        no_\n        ,country_code_iso3\n        ,item_category_code\n        ,manufacturer_code\n\n    from src\n\n)\n\nselect * from remaned_src"}, "error": null, "status": null, "execution_time": 0.02994084358215332, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.022834Z", "completed_at": "2020-10-11T08:32:38.052007Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.052372Z", "completed_at": "2020-10-11T08:32:38.052382Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from {{ source('stg_finance', 'navision_manufacturer') }}\n\n),\n\nremaned_src as (\n\n    select\n        name\n        ,country_code_iso3\n        ,code\n\n    from src\n\n)\n\nselect * from remaned_src", "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "staging", "stg_finance", "stg_navision_manufacturer"], "unique_id": "model.partner_portal.stg_navision_manufacturer", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "staging/stg_finance/stg_navision_manufacturer.sql", "original_file_path": "models/staging/stg_finance/stg_navision_manufacturer.sql", "name": "stg_navision_manufacturer", "resource_type": "model", "alias": "stg_navision_manufacturer", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "transient": true}, "tags": [], "refs": [], "sources": [["stg_finance", "navision_manufacturer"]], "depends_on": {"macros": [], "nodes": ["source.partner_portal.stg_finance.navision_manufacturer"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/stg_finance/stg_navision_manufacturer.sql", "compiled": true, "compiled_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.stg_finance.navision_manufacturer\n\n),\n\nremaned_src as (\n\n    select\n        name\n        ,country_code_iso3\n        ,code\n\n    from src\n\n)\n\nselect * from remaned_src", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.stg_finance.navision_manufacturer\n\n),\n\nremaned_src as (\n\n    select\n        name\n        ,country_code_iso3\n        ,code\n\n    from src\n\n)\n\nselect * from remaned_src"}, "error": null, "status": null, "execution_time": 0.03042745590209961, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.052998Z", "completed_at": "2020-10-11T08:32:38.082676Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.083030Z", "completed_at": "2020-10-11T08:32:38.083041Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from {{ source('stg_finance', 'navision_sp_fitting_header') }}\n\n),\n\nremaned_src as (\n\n    select\n        country_code_iso3\n        ,salesforce_id\n        ,no_\n\n    from src\n\n)\n\nselect * from remaned_src", "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "staging", "stg_finance", "stg_navision_sp_fitting_header"], "unique_id": "model.partner_portal.stg_navision_sp_fitting_header", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "staging/stg_finance/stg_navision_sp_fitting_header.sql", "original_file_path": "models/staging/stg_finance/stg_navision_sp_fitting_header.sql", "name": "stg_navision_sp_fitting_header", "resource_type": "model", "alias": "stg_navision_sp_fitting_header", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "transient": true}, "tags": [], "refs": [], "sources": [["stg_finance", "navision_sp_fitting_header"]], "depends_on": {"macros": [], "nodes": ["source.partner_portal.stg_finance.navision_sp_fitting_header"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/stg_finance/stg_navision_sp_fitting_header.sql", "compiled": true, "compiled_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.stg_finance.navision_sp_fitting_header\n\n),\n\nremaned_src as (\n\n    select\n        country_code_iso3\n        ,salesforce_id\n        ,no_\n\n    from src\n\n)\n\nselect * from remaned_src", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.stg_finance.navision_sp_fitting_header\n\n),\n\nremaned_src as (\n\n    select\n        country_code_iso3\n        ,salesforce_id\n        ,no_\n\n    from src\n\n)\n\nselect * from remaned_src"}, "error": null, "status": null, "execution_time": 0.027472496032714844, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.083652Z", "completed_at": "2020-10-11T08:32:38.110405Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.110743Z", "completed_at": "2020-10-11T08:32:38.110752Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from {{ source('stg_finance', 'navision_sp_fitting_line') }}\n\n),\n\nremaned_src as (\n\n    select\n        fitting_process_no_\n        ,no_\n        ,country_code_iso3\n    from src\n\n)\n\nselect * from remaned_src", "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "staging", "stg_finance", "stg_navision_sp_fitting_line"], "unique_id": "model.partner_portal.stg_navision_sp_fitting_line", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "staging/stg_finance/stg_navision_sp_fitting_line.sql", "original_file_path": "models/staging/stg_finance/stg_navision_sp_fitting_line.sql", "name": "stg_navision_sp_fitting_line", "resource_type": "model", "alias": "stg_navision_sp_fitting_line", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "transient": true}, "tags": [], "refs": [], "sources": [["stg_finance", "navision_sp_fitting_line"]], "depends_on": {"macros": [], "nodes": ["source.partner_portal.stg_finance.navision_sp_fitting_line"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/stg_finance/stg_navision_sp_fitting_line.sql", "compiled": true, "compiled_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.stg_finance.navision_sp_fitting_line\n\n),\n\nremaned_src as (\n\n    select\n        fitting_process_no_\n        ,no_\n        ,country_code_iso3\n    from src\n\n)\n\nselect * from remaned_src", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.stg_finance.navision_sp_fitting_line\n\n),\n\nremaned_src as (\n\n    select\n        fitting_process_no_\n        ,no_\n        ,country_code_iso3\n    from src\n\n)\n\nselect * from remaned_src"}, "error": null, "status": null, "execution_time": 0.028083324432373047, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.111347Z", "completed_at": "2020-10-11T08:32:38.138743Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.139049Z", "completed_at": "2020-10-11T08:32:38.139057Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from {{ source('ext_sales', 'salesforce_quote') }}\n\n),\n\nremaned_src as (\n\n    select\n        opportunityid,\n        createddate,\n        buying_type__c,\n        status,\n        id,\n        total_discount__c,\n        HEARING_AID_RIGHT__C,\n        HEARING_AID_LEFT__C,\n--        datetime,\n        selected_hearing_aid__c,\n        first_appointment_confirmed__c\n\n    from src\n\n)\n\nselect * from remaned_src", "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "staging", "ext_sales", "stg_salesforce_quote"], "unique_id": "model.partner_portal.stg_salesforce_quote", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "staging/ext_sales/stg_salesforce_quote.sql", "original_file_path": "models/staging/ext_sales/stg_salesforce_quote.sql", "name": "stg_salesforce_quote", "resource_type": "model", "alias": "stg_salesforce_quote", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "transient": true}, "tags": [], "refs": [], "sources": [["ext_sales", "salesforce_quote"]], "depends_on": {"macros": [], "nodes": ["source.partner_portal.ext_sales.salesforce_quote"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/ext_sales/stg_salesforce_quote.sql", "compiled": true, "compiled_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.ext_sales.salesforce_quote\n\n),\n\nremaned_src as (\n\n    select\n        opportunityid,\n        createddate,\n        buying_type__c,\n        status,\n        id,\n        total_discount__c,\n        HEARING_AID_RIGHT__C,\n        HEARING_AID_LEFT__C,\n--        datetime,\n        selected_hearing_aid__c,\n        first_appointment_confirmed__c\n\n    from src\n\n)\n\nselect * from remaned_src", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.ext_sales.salesforce_quote\n\n),\n\nremaned_src as (\n\n    select\n        opportunityid,\n        createddate,\n        buying_type__c,\n        status,\n        id,\n        total_discount__c,\n        HEARING_AID_RIGHT__C,\n        HEARING_AID_LEFT__C,\n--        datetime,\n        selected_hearing_aid__c,\n        first_appointment_confirmed__c\n\n    from src\n\n)\n\nselect * from remaned_src"}, "error": null, "status": null, "execution_time": 0.029231548309326172, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.139639Z", "completed_at": "2020-10-11T08:32:38.168202Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.168502Z", "completed_at": "2020-10-11T08:32:38.168509Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from {{ source('ext_sales', 'salesforce_account') }}\n\n),\n\nremaned_src as (\n\n    select\n        id,\n        parentid,\n        dw_modified_at,\n        billingpostalcode\n\n    from src\n\n)\n\nselect * from remaned_src", "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "staging", "ext_sales", "stg_salesforce_account"], "unique_id": "model.partner_portal.stg_salesforce_account", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "staging/ext_sales/stg_salesforce_account.sql", "original_file_path": "models/staging/ext_sales/stg_salesforce_account.sql", "name": "stg_salesforce_account", "resource_type": "model", "alias": "stg_salesforce_account", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "transient": true}, "tags": [], "refs": [], "sources": [["ext_sales", "salesforce_account"]], "depends_on": {"macros": [], "nodes": ["source.partner_portal.ext_sales.salesforce_account"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/ext_sales/stg_salesforce_account.sql", "compiled": true, "compiled_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.ext_sales.salesforce_account\n\n),\n\nremaned_src as (\n\n    select\n        id,\n        parentid,\n        dw_modified_at,\n        billingpostalcode\n\n    from src\n\n)\n\nselect * from remaned_src", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.ext_sales.salesforce_account\n\n),\n\nremaned_src as (\n\n    select\n        id,\n        parentid,\n        dw_modified_at,\n        billingpostalcode\n\n    from src\n\n)\n\nselect * from remaned_src"}, "error": null, "status": null, "execution_time": 0.028299331665039062, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.169093Z", "completed_at": "2020-10-11T08:32:38.196676Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.197010Z", "completed_at": "2020-10-11T08:32:38.197017Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from {{ source('ext_sales', 'salesforce_lead') }}\n\n),\n\nremaned_src as (\n\n    select\n        id,\n        convertedopportunityid,\n        dw_modified_at\n\n    from src\n\n)\n\nselect * from remaned_src", "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "staging", "ext_sales", "stg_salesforce_lead"], "unique_id": "model.partner_portal.stg_salesforce_lead", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "staging/ext_sales/stg_salesforce_lead.sql", "original_file_path": "models/staging/ext_sales/stg_salesforce_lead.sql", "name": "stg_salesforce_lead", "resource_type": "model", "alias": "stg_salesforce_lead", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "transient": true}, "tags": [], "refs": [], "sources": [["ext_sales", "salesforce_lead"]], "depends_on": {"macros": [], "nodes": ["source.partner_portal.ext_sales.salesforce_lead"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/ext_sales/stg_salesforce_lead.sql", "compiled": true, "compiled_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.ext_sales.salesforce_lead\n\n),\n\nremaned_src as (\n\n    select\n        id,\n        convertedopportunityid,\n        dw_modified_at\n\n    from src\n\n)\n\nselect * from remaned_src", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.ext_sales.salesforce_lead\n\n),\n\nremaned_src as (\n\n    select\n        id,\n        convertedopportunityid,\n        dw_modified_at\n\n    from src\n\n)\n\nselect * from remaned_src"}, "error": null, "status": null, "execution_time": 0.029456377029418945, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.197663Z", "completed_at": "2020-10-11T08:32:38.226382Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.226687Z", "completed_at": "2020-10-11T08:32:38.226694Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from {{ source('ext_sales', 'salesforce_opportunity') }}\n\n),\n\nremaned_src as (\n\n    select\n        createddate,\n        id,\n        ISO_COUNTRY_CODE_CUSTOMER__C,\n        pak_partnerid__c,\n        ab_helper_first_appointment__c,\n        partner_service_premium__c,\n        time_to_first_appointment__c,\n        accountid,\n        dw_modified_at\n\n    from src\n\n)\n\nselect * from remaned_src", "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "staging", "ext_sales", "stg_salesforce_opportunity"], "unique_id": "model.partner_portal.stg_salesforce_opportunity", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "staging/ext_sales/stg_salesforce_opportunity.sql", "original_file_path": "models/staging/ext_sales/stg_salesforce_opportunity.sql", "name": "stg_salesforce_opportunity", "resource_type": "model", "alias": "stg_salesforce_opportunity", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "transient": true}, "tags": [], "refs": [], "sources": [["ext_sales", "salesforce_opportunity"]], "depends_on": {"macros": [], "nodes": ["source.partner_portal.ext_sales.salesforce_opportunity"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/ext_sales/stg_salesforce_opportunity.sql", "compiled": true, "compiled_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.ext_sales.salesforce_opportunity\n\n),\n\nremaned_src as (\n\n    select\n        createddate,\n        id,\n        ISO_COUNTRY_CODE_CUSTOMER__C,\n        pak_partnerid__c,\n        ab_helper_first_appointment__c,\n        partner_service_premium__c,\n        time_to_first_appointment__c,\n        accountid,\n        dw_modified_at\n\n    from src\n\n)\n\nselect * from remaned_src", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.ext_sales.salesforce_opportunity\n\n),\n\nremaned_src as (\n\n    select\n        createddate,\n        id,\n        ISO_COUNTRY_CODE_CUSTOMER__C,\n        pak_partnerid__c,\n        ab_helper_first_appointment__c,\n        partner_service_premium__c,\n        time_to_first_appointment__c,\n        accountid,\n        dw_modified_at\n\n    from src\n\n)\n\nselect * from remaned_src"}, "error": null, "status": null, "execution_time": 0.02970147132873535, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.227280Z", "completed_at": "2020-10-11T08:32:38.256043Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.256466Z", "completed_at": "2020-10-11T08:32:38.256476Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from {{ source('ext_sales', 'salesforce_task') }}\n\n),\n\nremaned_src as (\n\n    select\n        opportunity__c,\n        worth_recognized__c\n\n    from src\n\n)\n\nselect * from remaned_src", "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "staging", "ext_sales", "stg_salesforce_task"], "unique_id": "model.partner_portal.stg_salesforce_task", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "staging/ext_sales/stg_salesforce_task.sql", "original_file_path": "models/staging/ext_sales/stg_salesforce_task.sql", "name": "stg_salesforce_task", "resource_type": "model", "alias": "stg_salesforce_task", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "transient": true}, "tags": [], "refs": [], "sources": [["ext_sales", "salesforce_task"]], "depends_on": {"macros": [], "nodes": ["source.partner_portal.ext_sales.salesforce_task"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/ext_sales/stg_salesforce_task.sql", "compiled": true, "compiled_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.ext_sales.salesforce_task\n\n),\n\nremaned_src as (\n\n    select\n        opportunity__c,\n        worth_recognized__c\n\n    from src\n\n)\n\nselect * from remaned_src", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "-- source has syntax Source {'schema_name','table_name'}\nwith src as (\n\n    select * from partner_portal.ext_sales.salesforce_task\n\n),\n\nremaned_src as (\n\n    select\n        opportunity__c,\n        worth_recognized__c\n\n    from src\n\n)\n\nselect * from remaned_src"}, "error": null, "status": null, "execution_time": 0.03473663330078125, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.257417Z", "completed_at": "2020-10-11T08:32:38.291105Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.291538Z", "completed_at": "2020-10-11T08:32:38.291549Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_accepted_values(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "accepted_values", "kwargs": {"values": ["CAN", "CHE", "CHN", "DEU", "FRA", "GBR", "HKG", "IND", "JPN", "KOR", "MYS", "N/A", "NLD", "SGP", "THA", "USA", "ZAF'"], "column_name": "country_code_iso3", "model": "{{ source('datamart', 'dim_opportunity') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "source_accepted_values_datamart_dim_opportunity_country_code_iso3__CAN__CHE__CHN__DEU__FRA__GBR__HKG__IND__JPN__KOR__MYS__N_A__NLD__SGP__THA__USA__ZAF_"], "unique_id": "test.partner_portal.source_accepted_values_datamart_dim_opportunity_country_code_iso3__CAN__CHE__CHN__DEU__FRA__GBR__HKG__IND__JPN__KOR__MYS__N_A__NLD__SGP__THA__USA__ZAF_", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/source_accepted_values_datamart_dim_opportunity_777efc2848f4a78747608c876e2973b6.sql", "original_file_path": "models/staging/datamart/src_datamart.yml", "name": "source_accepted_values_datamart_dim_opportunity_country_code_iso3__CAN__CHE__CHN__DEU__FRA__GBR__HKG__IND__JPN__KOR__MYS__N_A__NLD__SGP__THA__USA__ZAF_", "resource_type": "test", "alias": "source_accepted_values_datamart_dim_opportunity_country_code_iso3__CAN__CHE__CHN__DEU__FRA__GBR__HKG__IND__JPN__KOR__MYS__N_A__NLD__SGP__THA__USA__ZAF_", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [], "sources": [["datamart", "dim_opportunity"]], "depends_on": {"macros": ["macro.dbt.test_accepted_values"], "nodes": ["source.partner_portal.datamart.dim_opportunity"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/datamart/src_datamart.yml/schema_test/source_accepted_values_datamart_dim_opportunity_777efc2848f4a78747608c876e2973b6.sql", "compiled": true, "compiled_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        country_code_iso3 as value_field\n\n    from partner_portal.datamart.dim_opportunity\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'CAN','CHE','CHN','DEU','FRA','GBR','HKG','IND','JPN','KOR','MYS','N/A','NLD','SGP','THA','USA','ZAF''\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        country_code_iso3 as value_field\n\n    from partner_portal.datamart.dim_opportunity\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'CAN','CHE','CHN','DEU','FRA','GBR','HKG','IND','JPN','KOR','MYS','N/A','NLD','SGP','THA','USA','ZAF''\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "column_name": "country_code_iso3"}, "error": null, "status": null, "execution_time": 0.07675433158874512, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.292521Z", "completed_at": "2020-10-11T08:32:38.368502Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.368809Z", "completed_at": "2020-10-11T08:32:38.368818Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_accepted_values(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "accepted_values", "kwargs": {"values": ["CAN", "CHE", "CHN", "DEU", "FRA", "GBR", "HKG", "IND", "JPN", "KOR", "MYS", "N/A", "NLD", "SGP", "THA", "USA", "ZAF'"], "column_name": "country_code_iso3", "model": "{{ source('stg_finance', 'navision_sp_fitting_header') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "source_accepted_values_stg_finance_navision_sp_fitting_header_country_code_iso3__CAN__CHE__CHN__DEU__FRA__GBR__HKG__IND__JPN__KOR__MYS__N_A__NLD__SGP__THA__USA__ZAF_"], "unique_id": "test.partner_portal.source_accepted_values_stg_finance_navision_sp_fitting_header_country_code_iso3__CAN__CHE__CHN__DEU__FRA__GBR__HKG__IND__JPN__KOR__MYS__N_A__NLD__SGP__THA__USA__ZAF_", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/source_accepted_values_stg_finance_navision_sp_fitting_header_777efc2848f4a78747608c876e2973b6.sql", "original_file_path": "models/staging/stg_finance/src_stg_finance.yml", "name": "source_accepted_values_stg_finance_navision_sp_fitting_header_country_code_iso3__CAN__CHE__CHN__DEU__FRA__GBR__HKG__IND__JPN__KOR__MYS__N_A__NLD__SGP__THA__USA__ZAF_", "resource_type": "test", "alias": "source_accepted_values_stg_finance_navision_sp_fitting_header_country_code_iso3__CAN__CHE__CHN__DEU__FRA__GBR__HKG__IND__JPN__KOR__MYS__N_A__NLD__SGP__THA__USA__ZAF_", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [], "sources": [["stg_finance", "navision_sp_fitting_header"]], "depends_on": {"macros": ["macro.dbt.test_accepted_values"], "nodes": ["source.partner_portal.stg_finance.navision_sp_fitting_header"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/stg_finance/src_stg_finance.yml/schema_test/source_accepted_values_stg_finance_navision_sp_fitting_header_777efc2848f4a78747608c876e2973b6.sql", "compiled": true, "compiled_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        country_code_iso3 as value_field\n\n    from partner_portal.stg_finance.navision_sp_fitting_header\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'CAN','CHE','CHN','DEU','FRA','GBR','HKG','IND','JPN','KOR','MYS','N/A','NLD','SGP','THA','USA','ZAF''\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        country_code_iso3 as value_field\n\n    from partner_portal.stg_finance.navision_sp_fitting_header\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'CAN','CHE','CHN','DEU','FRA','GBR','HKG','IND','JPN','KOR','MYS','N/A','NLD','SGP','THA','USA','ZAF''\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "column_name": "country_code_iso3"}, "error": null, "status": null, "execution_time": 0.03766822814941406, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.369418Z", "completed_at": "2020-10-11T08:32:38.406411Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.406704Z", "completed_at": "2020-10-11T08:32:38.406712Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "id", "model": "{{ source('datamart', 'dim_opportunity') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "source_not_null_datamart_dim_opportunity_id"], "unique_id": "test.partner_portal.source_not_null_datamart_dim_opportunity_id", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/source_not_null_datamart_dim_opportunity_id.sql", "original_file_path": "models/staging/datamart/src_datamart.yml", "name": "source_not_null_datamart_dim_opportunity_id", "resource_type": "test", "alias": "source_not_null_datamart_dim_opportunity_id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [], "sources": [["datamart", "dim_opportunity"]], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["source.partner_portal.datamart.dim_opportunity"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/datamart/src_datamart.yml/schema_test/source_not_null_datamart_dim_opportunity_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom partner_portal.datamart.dim_opportunity\nwhere id is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom partner_portal.datamart.dim_opportunity\nwhere id is null\n\n", "column_name": "id"}, "error": null, "status": null, "execution_time": 0.031103134155273438, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.407297Z", "completed_at": "2020-10-11T08:32:38.437656Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.438016Z", "completed_at": "2020-10-11T08:32:38.438026Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "id", "model": "{{ source('datamart', 'dim_partner_subsidiary') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "source_not_null_datamart_dim_partner_subsidiary_id"], "unique_id": "test.partner_portal.source_not_null_datamart_dim_partner_subsidiary_id", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/source_not_null_datamart_dim_partner_subsidiary_id.sql", "original_file_path": "models/staging/datamart/src_datamart.yml", "name": "source_not_null_datamart_dim_partner_subsidiary_id", "resource_type": "test", "alias": "source_not_null_datamart_dim_partner_subsidiary_id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [], "sources": [["datamart", "dim_partner_subsidiary"]], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["source.partner_portal.datamart.dim_partner_subsidiary"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/datamart/src_datamart.yml/schema_test/source_not_null_datamart_dim_partner_subsidiary_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom partner_portal.datamart.dim_partner_subsidiary\nwhere id is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom partner_portal.datamart.dim_partner_subsidiary\nwhere id is null\n\n", "column_name": "id"}, "error": null, "status": null, "execution_time": 0.04160332679748535, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.438636Z", "completed_at": "2020-10-11T08:32:38.479387Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.479807Z", "completed_at": "2020-10-11T08:32:38.479820Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "salesforce_id", "model": "{{ source('stg_finance', 'navision_sp_fitting_header') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "source_not_null_stg_finance_navision_sp_fitting_header_salesforce_id"], "unique_id": "test.partner_portal.source_not_null_stg_finance_navision_sp_fitting_header_salesforce_id", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/source_not_null_stg_finance_navision_sp_fitting_header_salesforce_id.sql", "original_file_path": "models/staging/stg_finance/src_stg_finance.yml", "name": "source_not_null_stg_finance_navision_sp_fitting_header_salesforce_id", "resource_type": "test", "alias": "source_not_null_stg_finance_navision_sp_fitting_header_salesforce_id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [], "sources": [["stg_finance", "navision_sp_fitting_header"]], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["source.partner_portal.stg_finance.navision_sp_fitting_header"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/stg_finance/src_stg_finance.yml/schema_test/source_not_null_stg_finance_navision_sp_fitting_header_salesforce_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom partner_portal.stg_finance.navision_sp_fitting_header\nwhere salesforce_id is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom partner_portal.stg_finance.navision_sp_fitting_header\nwhere salesforce_id is null\n\n", "column_name": "salesforce_id"}, "error": null, "status": null, "execution_time": 0.03036808967590332, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.480497Z", "completed_at": "2020-10-11T08:32:38.510028Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.510423Z", "completed_at": "2020-10-11T08:32:38.510438Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "id", "model": "{{ source('datamart', 'dim_opportunity') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "source_unique_datamart_dim_opportunity_id"], "unique_id": "test.partner_portal.source_unique_datamart_dim_opportunity_id", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/source_unique_datamart_dim_opportunity_id.sql", "original_file_path": "models/staging/datamart/src_datamart.yml", "name": "source_unique_datamart_dim_opportunity_id", "resource_type": "test", "alias": "source_unique_datamart_dim_opportunity_id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [], "sources": [["datamart", "dim_opportunity"]], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["source.partner_portal.datamart.dim_opportunity"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/datamart/src_datamart.yml/schema_test/source_unique_datamart_dim_opportunity_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        id\n\n    from partner_portal.datamart.dim_opportunity\n    where id is not null\n    group by id\n    having count(*) > 1\n\n) validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        id\n\n    from partner_portal.datamart.dim_opportunity\n    where id is not null\n    group by id\n    having count(*) > 1\n\n) validation_errors\n\n", "column_name": "id"}, "error": null, "status": null, "execution_time": 0.032437801361083984, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.511110Z", "completed_at": "2020-10-11T08:32:38.542782Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.543144Z", "completed_at": "2020-10-11T08:32:38.543155Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "id", "model": "{{ source('datamart', 'dim_partner_subsidiary') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "source_unique_datamart_dim_partner_subsidiary_id"], "unique_id": "test.partner_portal.source_unique_datamart_dim_partner_subsidiary_id", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/source_unique_datamart_dim_partner_subsidiary_id.sql", "original_file_path": "models/staging/datamart/src_datamart.yml", "name": "source_unique_datamart_dim_partner_subsidiary_id", "resource_type": "test", "alias": "source_unique_datamart_dim_partner_subsidiary_id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [], "sources": [["datamart", "dim_partner_subsidiary"]], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["source.partner_portal.datamart.dim_partner_subsidiary"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/datamart/src_datamart.yml/schema_test/source_unique_datamart_dim_partner_subsidiary_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        id\n\n    from partner_portal.datamart.dim_partner_subsidiary\n    where id is not null\n    group by id\n    having count(*) > 1\n\n) validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        id\n\n    from partner_portal.datamart.dim_partner_subsidiary\n    where id is not null\n    group by id\n    having count(*) > 1\n\n) validation_errors\n\n", "column_name": "id"}, "error": null, "status": null, "execution_time": 0.028718233108520508, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.543768Z", "completed_at": "2020-10-11T08:32:38.571791Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.572103Z", "completed_at": "2020-10-11T08:32:38.572112Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "salesforce_id", "model": "{{ source('stg_finance', 'navision_sp_fitting_header') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "source_unique_stg_finance_navision_sp_fitting_header_salesforce_id"], "unique_id": "test.partner_portal.source_unique_stg_finance_navision_sp_fitting_header_salesforce_id", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/source_unique_stg_finance_navision_sp_fitting_header_salesforce_id.sql", "original_file_path": "models/staging/stg_finance/src_stg_finance.yml", "name": "source_unique_stg_finance_navision_sp_fitting_header_salesforce_id", "resource_type": "test", "alias": "source_unique_stg_finance_navision_sp_fitting_header_salesforce_id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [], "sources": [["stg_finance", "navision_sp_fitting_header"]], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["source.partner_portal.stg_finance.navision_sp_fitting_header"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/stg_finance/src_stg_finance.yml/schema_test/source_unique_stg_finance_navision_sp_fitting_header_salesforce_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        salesforce_id\n\n    from partner_portal.stg_finance.navision_sp_fitting_header\n    where salesforce_id is not null\n    group by salesforce_id\n    having count(*) > 1\n\n) validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        salesforce_id\n\n    from partner_portal.stg_finance.navision_sp_fitting_header\n    where salesforce_id is not null\n    group by salesforce_id\n    having count(*) > 1\n\n) validation_errors\n\n", "column_name": "salesforce_id"}, "error": null, "status": null, "execution_time": 0.03084731101989746, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.572698Z", "completed_at": "2020-10-11T08:32:38.602854Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.603165Z", "completed_at": "2020-10-11T08:32:38.603173Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_accepted_values(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "accepted_values", "kwargs": {"values": ["CAN", "CHE", "CHN", "DEU", "FRA", "GBR", "HKG", "IND", "JPN", "KOR", "MYS", "N/A", "NLD", "SGP", "THA", "USA", "ZAF'"], "column_name": "country_code_iso3", "model": "{{ ref('stg_dim_opportunity') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "accepted_values_stg_dim_opportunity_country_code_iso3__CAN__CHE__CHN__DEU__FRA__GBR__HKG__IND__JPN__KOR__MYS__N_A__NLD__SGP__THA__USA__ZAF_"], "unique_id": "test.partner_portal.accepted_values_stg_dim_opportunity_country_code_iso3__CAN__CHE__CHN__DEU__FRA__GBR__HKG__IND__JPN__KOR__MYS__N_A__NLD__SGP__THA__USA__ZAF_", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/accepted_values_stg_dim_opportunity_777efc2848f4a78747608c876e2973b6.sql", "original_file_path": "models/staging/datamart/stg_datamart.yml", "name": "accepted_values_stg_dim_opportunity_country_code_iso3__CAN__CHE__CHN__DEU__FRA__GBR__HKG__IND__JPN__KOR__MYS__N_A__NLD__SGP__THA__USA__ZAF_", "resource_type": "test", "alias": "accepted_values_stg_dim_opportunity_country_code_iso3__CAN__CHE__CHN__DEU__FRA__GBR__HKG__IND__JPN__KOR__MYS__N_A__NLD__SGP__THA__USA__ZAF_", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [["stg_dim_opportunity"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values"], "nodes": ["model.partner_portal.stg_dim_opportunity"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/datamart/stg_datamart.yml/schema_test/accepted_values_stg_dim_opportunity_777efc2848f4a78747608c876e2973b6.sql", "compiled": true, "compiled_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        country_code_iso3 as value_field\n\n    from PARTNER_PORTAL.dbt_adhingra.stg_dim_opportunity\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'CAN','CHE','CHN','DEU','FRA','GBR','HKG','IND','JPN','KOR','MYS','N/A','NLD','SGP','THA','USA','ZAF''\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        country_code_iso3 as value_field\n\n    from PARTNER_PORTAL.dbt_adhingra.stg_dim_opportunity\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'CAN','CHE','CHN','DEU','FRA','GBR','HKG','IND','JPN','KOR','MYS','N/A','NLD','SGP','THA','USA','ZAF''\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "column_name": "country_code_iso3"}, "error": null, "status": null, "execution_time": 0.03649330139160156, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.603775Z", "completed_at": "2020-10-11T08:32:38.639538Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.639876Z", "completed_at": "2020-10-11T08:32:38.639885Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "id", "model": "{{ ref('stg_dim_opportunity') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "not_null_stg_dim_opportunity_id"], "unique_id": "test.partner_portal.not_null_stg_dim_opportunity_id", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/not_null_stg_dim_opportunity_id.sql", "original_file_path": "models/staging/datamart/stg_datamart.yml", "name": "not_null_stg_dim_opportunity_id", "resource_type": "test", "alias": "not_null_stg_dim_opportunity_id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [["stg_dim_opportunity"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.partner_portal.stg_dim_opportunity"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/datamart/stg_datamart.yml/schema_test/not_null_stg_dim_opportunity_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom PARTNER_PORTAL.dbt_adhingra.stg_dim_opportunity\nwhere id is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom PARTNER_PORTAL.dbt_adhingra.stg_dim_opportunity\nwhere id is null\n\n", "column_name": "id"}, "error": null, "status": null, "execution_time": 0.029604434967041016, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.640490Z", "completed_at": "2020-10-11T08:32:38.669291Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.669686Z", "completed_at": "2020-10-11T08:32:38.669696Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "partner_id", "model": "{{ ref('stg_dim_opportunity') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "not_null_stg_dim_opportunity_partner_id"], "unique_id": "test.partner_portal.not_null_stg_dim_opportunity_partner_id", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/not_null_stg_dim_opportunity_partner_id.sql", "original_file_path": "models/staging/datamart/stg_datamart.yml", "name": "not_null_stg_dim_opportunity_partner_id", "resource_type": "test", "alias": "not_null_stg_dim_opportunity_partner_id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [["stg_dim_opportunity"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.partner_portal.stg_dim_opportunity"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/datamart/stg_datamart.yml/schema_test/not_null_stg_dim_opportunity_partner_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom PARTNER_PORTAL.dbt_adhingra.stg_dim_opportunity\nwhere partner_id is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom PARTNER_PORTAL.dbt_adhingra.stg_dim_opportunity\nwhere partner_id is null\n\n", "column_name": "partner_id"}, "error": null, "status": null, "execution_time": 0.029554367065429688, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.670322Z", "completed_at": "2020-10-11T08:32:38.699106Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.699482Z", "completed_at": "2020-10-11T08:32:38.699492Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "id", "model": "{{ ref('stg_dim_opportunity') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "unique_stg_dim_opportunity_id"], "unique_id": "test.partner_portal.unique_stg_dim_opportunity_id", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/unique_stg_dim_opportunity_id.sql", "original_file_path": "models/staging/datamart/stg_datamart.yml", "name": "unique_stg_dim_opportunity_id", "resource_type": "test", "alias": "unique_stg_dim_opportunity_id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [["stg_dim_opportunity"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.partner_portal.stg_dim_opportunity"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/datamart/stg_datamart.yml/schema_test/unique_stg_dim_opportunity_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        id\n\n    from PARTNER_PORTAL.dbt_adhingra.stg_dim_opportunity\n    where id is not null\n    group by id\n    having count(*) > 1\n\n) validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        id\n\n    from PARTNER_PORTAL.dbt_adhingra.stg_dim_opportunity\n    where id is not null\n    group by id\n    having count(*) > 1\n\n) validation_errors\n\n", "column_name": "id"}, "error": null, "status": null, "execution_time": 0.029302597045898438, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.700108Z", "completed_at": "2020-10-11T08:32:38.728666Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.728995Z", "completed_at": "2020-10-11T08:32:38.729003Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "partner_id", "model": "{{ ref('stg_dim_opportunity') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "unique_stg_dim_opportunity_partner_id"], "unique_id": "test.partner_portal.unique_stg_dim_opportunity_partner_id", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/unique_stg_dim_opportunity_partner_id.sql", "original_file_path": "models/staging/datamart/stg_datamart.yml", "name": "unique_stg_dim_opportunity_partner_id", "resource_type": "test", "alias": "unique_stg_dim_opportunity_partner_id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [["stg_dim_opportunity"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.partner_portal.stg_dim_opportunity"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/datamart/stg_datamart.yml/schema_test/unique_stg_dim_opportunity_partner_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        partner_id\n\n    from PARTNER_PORTAL.dbt_adhingra.stg_dim_opportunity\n    where partner_id is not null\n    group by partner_id\n    having count(*) > 1\n\n) validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        partner_id\n\n    from PARTNER_PORTAL.dbt_adhingra.stg_dim_opportunity\n    where partner_id is not null\n    group by partner_id\n    having count(*) > 1\n\n) validation_errors\n\n", "column_name": "partner_id"}, "error": null, "status": null, "execution_time": 0.030025720596313477, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.729704Z", "completed_at": "2020-10-11T08:32:38.758988Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.759291Z", "completed_at": "2020-10-11T08:32:38.759299Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "-- uses only dim_opp and dim_partner subsidiary, calculates ongoing potential and avg_days_to_first_appointment +network\nWITH ocd_metrics AS (\n      SELECT\n        p.parent_id,\n        p.id,\n        date_trunc('year', cast(o.created_date as timestamp)) :: DATE                                               AS date_year,\n        count(o.id)                                                                              AS customer_potential,\n        count(case when o.stage_name NOT IN ('in process', 'appointment to be made', 'on hold') then o.id end) AS ongoing_potential,\n        avg(case when o.days_to_first_appointment IS NOT NULL AND o.days_to_first_appointment < 60 then o.days_to_first_appointment end)  AS avg_days_to_first_appointment\n      FROM {{ref('stg_dim_opportunity')}} as o\n        LEFT JOIN {{ref('stg_dim_partner_subsidiary')}} as p ON o.partner_id = p.id\n      WHERE o.country_code_iso3 = 'DEU' AND p.id IS NOT NULL\n      GROUP BY 1, 2, 3\n  ), ranked AS (\n      SELECT\n        ocd.*,\n        row_number()\n        OVER (\n          PARTITION BY ocd.date_year\n          ORDER BY avg_days_to_first_appointment ASC ) AS avg_days_to_first_appointment_rank,\n        row_number()\n        OVER (\n          PARTITION BY ocd.date_year\n          ORDER BY customer_potential DESC )           AS customer_potential_rank\n      FROM ocd_metrics ocd\n  ), top20 AS (\n      SELECT\n        date_year,\n        avg(case when avg_days_to_first_appointment_rank <= 20 then avg_days_to_first_appointment end) AS top20_avg_days_to_first_appointment,\n        avg(case when customer_potential_rank <= 20 then customer_potential end) AS top20_customer_potential\n      FROM ranked\n      GROUP BY 1\n  ), market_avg AS (\n      SELECT\n        date_year,\n        avg(customer_potential)            AS market_avg_customer_potential,\n        avg(avg_days_to_first_appointment) AS market_avg_days_to_first_appointment\n      FROM ocd_metrics\n      GROUP BY 1\n  ) SELECT\n      ocd.*,\n      top20.top20_avg_days_to_first_appointment,\n      top20_customer_potential,\n      market_avg_customer_potential,\n      market_avg_days_to_first_appointment\n    FROM ocd_metrics ocd\n      LEFT JOIN top20 ON ocd.date_year = top20.date_year\n      LEFT JOIN market_avg ON ocd.date_year = market_avg.date_year", "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "views_per_country", "deu_ocd_yearly"], "unique_id": "model.partner_portal.deu_ocd_yearly", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "views_per_country/deu_ocd_yearly.sql", "original_file_path": "models/views_per_country/deu_ocd_yearly.sql", "name": "deu_ocd_yearly", "resource_type": "model", "alias": "deu_ocd_yearly", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "transient": true}, "tags": [], "refs": [["stg_dim_opportunity"], ["stg_dim_partner_subsidiary"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.partner_portal.stg_dim_opportunity", "model.partner_portal.stg_dim_partner_subsidiary"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/views_per_country/deu_ocd_yearly.sql", "compiled": true, "compiled_sql": "-- uses only dim_opp and dim_partner subsidiary, calculates ongoing potential and avg_days_to_first_appointment +network\nWITH ocd_metrics AS (\n      SELECT\n        p.parent_id,\n        p.id,\n        date_trunc('year', cast(o.created_date as timestamp)) :: DATE                                               AS date_year,\n        count(o.id)                                                                              AS customer_potential,\n        count(case when o.stage_name NOT IN ('in process', 'appointment to be made', 'on hold') then o.id end) AS ongoing_potential,\n        avg(case when o.days_to_first_appointment IS NOT NULL AND o.days_to_first_appointment < 60 then o.days_to_first_appointment end)  AS avg_days_to_first_appointment\n      FROM PARTNER_PORTAL.dbt_adhingra.stg_dim_opportunity as o\n        LEFT JOIN PARTNER_PORTAL.dbt_adhingra.stg_dim_partner_subsidiary as p ON o.partner_id = p.id\n      WHERE o.country_code_iso3 = 'DEU' AND p.id IS NOT NULL\n      GROUP BY 1, 2, 3\n  ), ranked AS (\n      SELECT\n        ocd.*,\n        row_number()\n        OVER (\n          PARTITION BY ocd.date_year\n          ORDER BY avg_days_to_first_appointment ASC ) AS avg_days_to_first_appointment_rank,\n        row_number()\n        OVER (\n          PARTITION BY ocd.date_year\n          ORDER BY customer_potential DESC )           AS customer_potential_rank\n      FROM ocd_metrics ocd\n  ), top20 AS (\n      SELECT\n        date_year,\n        avg(case when avg_days_to_first_appointment_rank <= 20 then avg_days_to_first_appointment end) AS top20_avg_days_to_first_appointment,\n        avg(case when customer_potential_rank <= 20 then customer_potential end) AS top20_customer_potential\n      FROM ranked\n      GROUP BY 1\n  ), market_avg AS (\n      SELECT\n        date_year,\n        avg(customer_potential)            AS market_avg_customer_potential,\n        avg(avg_days_to_first_appointment) AS market_avg_days_to_first_appointment\n      FROM ocd_metrics\n      GROUP BY 1\n  ) SELECT\n      ocd.*,\n      top20.top20_avg_days_to_first_appointment,\n      top20_customer_potential,\n      market_avg_customer_potential,\n      market_avg_days_to_first_appointment\n    FROM ocd_metrics ocd\n      LEFT JOIN top20 ON ocd.date_year = top20.date_year\n      LEFT JOIN market_avg ON ocd.date_year = market_avg.date_year", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "-- uses only dim_opp and dim_partner subsidiary, calculates ongoing potential and avg_days_to_first_appointment +network\nWITH ocd_metrics AS (\n      SELECT\n        p.parent_id,\n        p.id,\n        date_trunc('year', cast(o.created_date as timestamp)) :: DATE                                               AS date_year,\n        count(o.id)                                                                              AS customer_potential,\n        count(case when o.stage_name NOT IN ('in process', 'appointment to be made', 'on hold') then o.id end) AS ongoing_potential,\n        avg(case when o.days_to_first_appointment IS NOT NULL AND o.days_to_first_appointment < 60 then o.days_to_first_appointment end)  AS avg_days_to_first_appointment\n      FROM PARTNER_PORTAL.dbt_adhingra.stg_dim_opportunity as o\n        LEFT JOIN PARTNER_PORTAL.dbt_adhingra.stg_dim_partner_subsidiary as p ON o.partner_id = p.id\n      WHERE o.country_code_iso3 = 'DEU' AND p.id IS NOT NULL\n      GROUP BY 1, 2, 3\n  ), ranked AS (\n      SELECT\n        ocd.*,\n        row_number()\n        OVER (\n          PARTITION BY ocd.date_year\n          ORDER BY avg_days_to_first_appointment ASC ) AS avg_days_to_first_appointment_rank,\n        row_number()\n        OVER (\n          PARTITION BY ocd.date_year\n          ORDER BY customer_potential DESC )           AS customer_potential_rank\n      FROM ocd_metrics ocd\n  ), top20 AS (\n      SELECT\n        date_year,\n        avg(case when avg_days_to_first_appointment_rank <= 20 then avg_days_to_first_appointment end) AS top20_avg_days_to_first_appointment,\n        avg(case when customer_potential_rank <= 20 then customer_potential end) AS top20_customer_potential\n      FROM ranked\n      GROUP BY 1\n  ), market_avg AS (\n      SELECT\n        date_year,\n        avg(customer_potential)            AS market_avg_customer_potential,\n        avg(avg_days_to_first_appointment) AS market_avg_days_to_first_appointment\n      FROM ocd_metrics\n      GROUP BY 1\n  ) SELECT\n      ocd.*,\n      top20.top20_avg_days_to_first_appointment,\n      top20_customer_potential,\n      market_avg_customer_potential,\n      market_avg_days_to_first_appointment\n    FROM ocd_metrics ocd\n      LEFT JOIN top20 ON ocd.date_year = top20.date_year\n      LEFT JOIN market_avg ON ocd.date_year = market_avg.date_year"}, "error": null, "status": null, "execution_time": 0.030689001083374023, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.759891Z", "completed_at": "2020-10-11T08:32:38.789911Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.790209Z", "completed_at": "2020-10-11T08:32:38.790216Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "id", "model": "{{ ref('stg_dim_partner_subsidiary') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "not_null_stg_dim_partner_subsidiary_id"], "unique_id": "test.partner_portal.not_null_stg_dim_partner_subsidiary_id", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/not_null_stg_dim_partner_subsidiary_id.sql", "original_file_path": "models/staging/datamart/stg_datamart.yml", "name": "not_null_stg_dim_partner_subsidiary_id", "resource_type": "test", "alias": "not_null_stg_dim_partner_subsidiary_id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [["stg_dim_partner_subsidiary"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.partner_portal.stg_dim_partner_subsidiary"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/datamart/stg_datamart.yml/schema_test/not_null_stg_dim_partner_subsidiary_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom PARTNER_PORTAL.dbt_adhingra.stg_dim_partner_subsidiary\nwhere id is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom PARTNER_PORTAL.dbt_adhingra.stg_dim_partner_subsidiary\nwhere id is null\n\n", "column_name": "id"}, "error": null, "status": null, "execution_time": 0.028975725173950195, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.790797Z", "completed_at": "2020-10-11T08:32:38.819077Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.819389Z", "completed_at": "2020-10-11T08:32:38.819398Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='WARN') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "id", "model": "{{ ref('stg_dim_partner_subsidiary') }}"}}, "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "schema_test", "unique_stg_dim_partner_subsidiary_id"], "unique_id": "test.partner_portal.unique_stg_dim_partner_subsidiary_id", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "schema_test/unique_stg_dim_partner_subsidiary_id.sql", "original_file_path": "models/staging/datamart/stg_datamart.yml", "name": "unique_stg_dim_partner_subsidiary_id", "resource_type": "test", "alias": "unique_stg_dim_partner_subsidiary_id", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "WARN", "transient": true}, "tags": ["schema"], "refs": [["stg_dim_partner_subsidiary"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.partner_portal.stg_dim_partner_subsidiary"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/staging/datamart/stg_datamart.yml/schema_test/unique_stg_dim_partner_subsidiary_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        id\n\n    from PARTNER_PORTAL.dbt_adhingra.stg_dim_partner_subsidiary\n    where id is not null\n    group by id\n    having count(*) > 1\n\n) validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        id\n\n    from PARTNER_PORTAL.dbt_adhingra.stg_dim_partner_subsidiary\n    where id is not null\n    group by id\n    having count(*) > 1\n\n) validation_errors\n\n", "column_name": "id"}, "error": null, "status": null, "execution_time": 0.029889583587646484, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.820001Z", "completed_at": "2020-10-11T08:32:38.849136Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.849459Z", "completed_at": "2020-10-11T08:32:38.849467Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "WITH sf_final_quote AS (\n    -- Get id/discount__c of the \"final final\" quote\n      SELECT\n        id,\n        total_discount__c\n      FROM {{ref('stg_salesforce_quote')}} q INNER JOIN\n        -- Sub-query defines the \"final final\" quote on a given opportunity. Def provided by Oliver O.\n        (\n          SELECT\n            opportunityid,\n            max(createddate) AS createddate\n          FROM {{ref('stg_salesforce_quote')}}\n          WHERE status = 'Final Quote' AND coalesce(hearing_aid_right__c, hearing_aid_left__c) IS NOT NULL\n          -- WHERE status = 'Final Quote' AND total__c >= 1000     NOTE: OLD Definition\n          GROUP BY 1\n        ) max_quote ON q.opportunityid = max_quote.opportunityid AND q.createddate = max_quote.createddate\n  ), mfr_counts AS (\n      SELECT\n        fh.country_code_iso3,\n        fh.salesforce_id,\n        mfr.name       AS manufacturer,\n        count(itm.no_) AS number_of_devices\n      FROM {{ref('stg_navision_sp_fitting_header')}} fh\n        INNER JOIN {{ref('stg_navision_sp_fitting_line')}} fl\n          ON fh.no_ = fl.fitting_process_no_ AND fh.country_code_iso3 = fl.country_code_iso3\n        INNER JOIN sf_final_quote fq ON fh.salesforce_id = fq.id\n        LEFT JOIN {{ref('stg_navision_item')}} AS itm\n          ON fl.no_ = itm.no_ AND fl.country_code_iso3 = itm.country_code_iso3 AND itm.item_category_code = 'HA'\n        LEFT JOIN {{ref('stg_navision_manufacturer')}} mfr\n          ON itm.country_code_iso3 = mfr.country_code_iso3 AND itm.manufacturer_code = mfr.code\n      WHERE fh.country_code_iso3 IN ('DEU') AND mfr.code IS NOT NULL\n      GROUP BY 1, 2, 3\n  )\n  SELECT\n    p.parent_id,\n    p.id,\n    mfr_counts.manufacturer,\n    date_trunc('year', cast(o.finished_date as timestamp)) :: DATE AS date_month,\n    sum(number_of_devices)                      AS number_of_devices\n  FROM mfr_counts\n    INNER JOIN {{ref('stg_salesforce_quote')}} as q ON mfr_counts.salesforce_id = q.id\n    INNER JOIN {{ref('stg_dim_opportunity')}} as o ON q.opportunityid = o.id\n    LEFT JOIN {{ref('stg_dim_partner_subsidiary')}} as p ON o.partner_id = p.id\n  WHERE o.stage_name = 'closed and won' -- AND date_trunc('month', o.finished_date) :: DATE >= '2017-10-01'\n  GROUP BY 1, 2, 3, 4\n  ORDER BY 4 DESC", "database": "PARTNER_PORTAL", "schema": "dbt_adhingra", "fqn": ["partner_portal", "views_per_country", "deu_device_yearly"], "unique_id": "model.partner_portal.deu_device_yearly", "package_name": "partner_portal", "root_path": "/usr/src/develop/user-7231/environment-10757/repository-9029", "path": "views_per_country/deu_device_yearly.sql", "original_file_path": "models/views_per_country/deu_device_yearly.sql", "name": "deu_device_yearly", "resource_type": "model", "alias": "deu_device_yearly", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "transient": true}, "tags": [], "refs": [["stg_salesforce_quote"], ["stg_salesforce_quote"], ["stg_navision_sp_fitting_header"], ["stg_navision_sp_fitting_line"], ["stg_navision_item"], ["stg_navision_manufacturer"], ["stg_salesforce_quote"], ["stg_dim_opportunity"], ["stg_dim_partner_subsidiary"]], "sources": [], "depends_on": {"macros": [], "nodes": ["model.partner_portal.stg_salesforce_quote", "model.partner_portal.stg_salesforce_quote", "model.partner_portal.stg_navision_sp_fitting_header", "model.partner_portal.stg_navision_sp_fitting_line", "model.partner_portal.stg_navision_item", "model.partner_portal.stg_navision_manufacturer", "model.partner_portal.stg_salesforce_quote", "model.partner_portal.stg_dim_opportunity", "model.partner_portal.stg_dim_partner_subsidiary"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/partner_portal/models/views_per_country/deu_device_yearly.sql", "compiled": true, "compiled_sql": "WITH sf_final_quote AS (\n    -- Get id/discount__c of the \"final final\" quote\n      SELECT\n        id,\n        total_discount__c\n      FROM PARTNER_PORTAL.dbt_adhingra.stg_salesforce_quote q INNER JOIN\n        -- Sub-query defines the \"final final\" quote on a given opportunity. Def provided by Oliver O.\n        (\n          SELECT\n            opportunityid,\n            max(createddate) AS createddate\n          FROM PARTNER_PORTAL.dbt_adhingra.stg_salesforce_quote\n          WHERE status = 'Final Quote' AND coalesce(hearing_aid_right__c, hearing_aid_left__c) IS NOT NULL\n          -- WHERE status = 'Final Quote' AND total__c >= 1000     NOTE: OLD Definition\n          GROUP BY 1\n        ) max_quote ON q.opportunityid = max_quote.opportunityid AND q.createddate = max_quote.createddate\n  ), mfr_counts AS (\n      SELECT\n        fh.country_code_iso3,\n        fh.salesforce_id,\n        mfr.name       AS manufacturer,\n        count(itm.no_) AS number_of_devices\n      FROM PARTNER_PORTAL.dbt_adhingra.stg_navision_sp_fitting_header fh\n        INNER JOIN PARTNER_PORTAL.dbt_adhingra.stg_navision_sp_fitting_line fl\n          ON fh.no_ = fl.fitting_process_no_ AND fh.country_code_iso3 = fl.country_code_iso3\n        INNER JOIN sf_final_quote fq ON fh.salesforce_id = fq.id\n        LEFT JOIN PARTNER_PORTAL.dbt_adhingra.stg_navision_item AS itm\n          ON fl.no_ = itm.no_ AND fl.country_code_iso3 = itm.country_code_iso3 AND itm.item_category_code = 'HA'\n        LEFT JOIN PARTNER_PORTAL.dbt_adhingra.stg_navision_manufacturer mfr\n          ON itm.country_code_iso3 = mfr.country_code_iso3 AND itm.manufacturer_code = mfr.code\n      WHERE fh.country_code_iso3 IN ('DEU') AND mfr.code IS NOT NULL\n      GROUP BY 1, 2, 3\n  )\n  SELECT\n    p.parent_id,\n    p.id,\n    mfr_counts.manufacturer,\n    date_trunc('year', cast(o.finished_date as timestamp)) :: DATE AS date_month,\n    sum(number_of_devices)                      AS number_of_devices\n  FROM mfr_counts\n    INNER JOIN PARTNER_PORTAL.dbt_adhingra.stg_salesforce_quote as q ON mfr_counts.salesforce_id = q.id\n    INNER JOIN PARTNER_PORTAL.dbt_adhingra.stg_dim_opportunity as o ON q.opportunityid = o.id\n    LEFT JOIN PARTNER_PORTAL.dbt_adhingra.stg_dim_partner_subsidiary as p ON o.partner_id = p.id\n  WHERE o.stage_name = 'closed and won' -- AND date_trunc('month', o.finished_date) :: DATE >= '2017-10-01'\n  GROUP BY 1, 2, 3, 4\n  ORDER BY 4 DESC", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "WITH sf_final_quote AS (\n    -- Get id/discount__c of the \"final final\" quote\n      SELECT\n        id,\n        total_discount__c\n      FROM PARTNER_PORTAL.dbt_adhingra.stg_salesforce_quote q INNER JOIN\n        -- Sub-query defines the \"final final\" quote on a given opportunity. Def provided by Oliver O.\n        (\n          SELECT\n            opportunityid,\n            max(createddate) AS createddate\n          FROM PARTNER_PORTAL.dbt_adhingra.stg_salesforce_quote\n          WHERE status = 'Final Quote' AND coalesce(hearing_aid_right__c, hearing_aid_left__c) IS NOT NULL\n          -- WHERE status = 'Final Quote' AND total__c >= 1000     NOTE: OLD Definition\n          GROUP BY 1\n        ) max_quote ON q.opportunityid = max_quote.opportunityid AND q.createddate = max_quote.createddate\n  ), mfr_counts AS (\n      SELECT\n        fh.country_code_iso3,\n        fh.salesforce_id,\n        mfr.name       AS manufacturer,\n        count(itm.no_) AS number_of_devices\n      FROM PARTNER_PORTAL.dbt_adhingra.stg_navision_sp_fitting_header fh\n        INNER JOIN PARTNER_PORTAL.dbt_adhingra.stg_navision_sp_fitting_line fl\n          ON fh.no_ = fl.fitting_process_no_ AND fh.country_code_iso3 = fl.country_code_iso3\n        INNER JOIN sf_final_quote fq ON fh.salesforce_id = fq.id\n        LEFT JOIN PARTNER_PORTAL.dbt_adhingra.stg_navision_item AS itm\n          ON fl.no_ = itm.no_ AND fl.country_code_iso3 = itm.country_code_iso3 AND itm.item_category_code = 'HA'\n        LEFT JOIN PARTNER_PORTAL.dbt_adhingra.stg_navision_manufacturer mfr\n          ON itm.country_code_iso3 = mfr.country_code_iso3 AND itm.manufacturer_code = mfr.code\n      WHERE fh.country_code_iso3 IN ('DEU') AND mfr.code IS NOT NULL\n      GROUP BY 1, 2, 3\n  )\n  SELECT\n    p.parent_id,\n    p.id,\n    mfr_counts.manufacturer,\n    date_trunc('year', cast(o.finished_date as timestamp)) :: DATE AS date_month,\n    sum(number_of_devices)                      AS number_of_devices\n  FROM mfr_counts\n    INNER JOIN PARTNER_PORTAL.dbt_adhingra.stg_salesforce_quote as q ON mfr_counts.salesforce_id = q.id\n    INNER JOIN PARTNER_PORTAL.dbt_adhingra.stg_dim_opportunity as o ON q.opportunityid = o.id\n    LEFT JOIN PARTNER_PORTAL.dbt_adhingra.stg_dim_partner_subsidiary as p ON o.partner_id = p.id\n  WHERE o.stage_name = 'closed and won' -- AND date_trunc('month', o.finished_date) :: DATE >= '2017-10-01'\n  GROUP BY 1, 2, 3, 4\n  ORDER BY 4 DESC"}, "error": null, "status": null, "execution_time": 0.0859377384185791, "thread_id": "Thread-2", "timing": [{"name": "compile", "started_at": "2020-10-11T08:32:38.850123Z", "completed_at": "2020-10-11T08:32:38.935233Z"}, {"name": "execute", "started_at": "2020-10-11T08:32:38.935652Z", "completed_at": "2020-10-11T08:32:38.935662Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2020-10-11T08:32:39.006386Z", "elapsed_time": 2.4594547748565674}